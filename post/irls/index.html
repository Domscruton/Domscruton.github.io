<!DOCTYPE html><html lang="en-us" >

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.3.0 for Hugo" />
  

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Dominic Scruton" />

  
  
  
    
  
  <meta name="description" content="Intuition behind the Link function, discussion of the various model fitting techniques and their advantages &amp; disadvantages, derivation of IRLS using Newton-Raphson and Fisher Scoring
GLMs - A Natural Extension of the Linear ModelThe first model we learn on any statistics-based course is Simple Linear Regression (SLR)." />

  
  <link rel="alternate" hreflang="en-us" href="https://domscruton.github.io/post/irls/" />

  









  




  
  
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    <meta name="theme-color" content="#1565c0" />
  

  
  
    
    <script src="/js/mathjax-config.js"></script>
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.f1ecf783c14edc00c9320c205831ad8e.css" media="print" onload="this.media='all'">

  
  
  
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    
    
    
    
      
      
    
    
    

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
        
      
    

    
    
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.481af39c39ffd87b2d14f39943e7c723.css" />

  



  

  

  




  
  
  

  

  
    <link rel="manifest" href="/manifest.webmanifest" />
  

  <link rel="icon" type="image/png" href="/media/icon_huf497c2b2f164bad8bc149e8f8dbb116c_2858_32x32_fill_lanczos_center_3.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_huf497c2b2f164bad8bc149e8f8dbb116c_2858_180x180_fill_lanczos_center_3.png" />

  <link rel="canonical" href="https://domscruton.github.io/post/irls/" />

  
  
  
  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary" />
  
  <meta property="og:site_name" content="Dominic Scruton" />
  <meta property="og:url" content="https://domscruton.github.io/post/irls/" />
  <meta property="og:title" content="GLMs: Intuition behind the Link function and Derivation of Iteratively Reweighted Least Squares | Dominic Scruton" />
  <meta property="og:description" content="Intuition behind the Link function, discussion of the various model fitting techniques and their advantages &amp; disadvantages, derivation of IRLS using Newton-Raphson and Fisher Scoring
GLMs - A Natural Extension of the Linear ModelThe first model we learn on any statistics-based course is Simple Linear Regression (SLR)." /><meta property="og:image" content="https://domscruton.github.io/media/icon_huf497c2b2f164bad8bc149e8f8dbb116c_2858_512x512_fill_lanczos_center_3.png" />
    <meta property="twitter:image" content="https://domscruton.github.io/media/icon_huf497c2b2f164bad8bc149e8f8dbb116c_2858_512x512_fill_lanczos_center_3.png" /><meta property="og:locale" content="en-us" />
  
    
      <meta
        property="article:published_time"
        content="2022-02-01T00:00:00&#43;00:00"
      />
    
    <meta property="article:modified_time" content="2022-02-01T00:00:00&#43;00:00">
  

  


    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://domscruton.github.io/post/irls/"
  },
  "headline": "GLMs: Intuition behind the Link function and Derivation of Iteratively Reweighted Least Squares",
  
  "datePublished": "2022-02-01T00:00:00Z",
  "dateModified": "2022-02-01T00:00:00Z",
  
  "author": {
    "@type": "Person",
    "name": "Dominic Scruton"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Dominic Scruton",
    "logo": {
      "@type": "ImageObject",
      "url": "https://domscruton.github.io/media/icon_huf497c2b2f164bad8bc149e8f8dbb116c_2858_192x192_fill_lanczos_center_3.png"
    }
  },
  "description": "Intuition behind the Link function, discussion of the various model fitting techniques and their advantages \u0026amp; disadvantages, derivation of IRLS using Newton-Raphson and Fisher Scoring\nGLMs - A Natural Extension of the Linear Model\rThe first model we learn on any statistics-based course is Simple Linear Regression (SLR)."
}
</script>

  

  

  

  





  <title>GLMs: Intuition behind the Link function and Derivation of Iteratively Reweighted Least Squares | Dominic Scruton</title>
</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="1d18452d5cfa24d9e05fd0bc1f8f26e5" >

  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.8988fb2a4bba758785868cfcb5244555.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    












<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container-xl">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">Dominic Scruton</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">Dominic Scruton</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Blog</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

      
      
        
      

      
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
          <i class="fas fa-moon" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      
      

    </ul>

  </div>
</nav>


  </div>

  <div class="page-body">
    <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1>GLMs: Intuition behind the Link function and Derivation of Iteratively Reweighted Least Squares</h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Feb 1, 2022
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    15 min read
  </span>
  

  
  
  
  
  
  

  
  

</div>

    





  
</div>



  <div class="article-container">

    <div class="article-style">
      
<script src="https://domscruton.github.io/post/irls/index_files/header-attrs/header-attrs.js"></script>


<p><em>Intuition behind the Link function, discussion of the various model fitting techniques and their advantages &amp; disadvantages, derivation of IRLS using Newton-Raphson and Fisher Scoring</em></p>
<div id="glms---a-natural-extension-of-the-linear-model" class="section level2">
<h2>GLMs - A Natural Extension of the Linear Model</h2>
<p>The first model we learn on any statistics-based course is Simple Linear Regression (SLR). Despite placing strong (linear) assumptions on the relationship between the response and covariates, as well as the error distribution if we are interested in statistical inference, the Linear model is a surprisingly useful tool for representing many natural processes. However, when we wish to deal with non-linear random variable generating processes, such as the probability of occurrence of an event from a binary or multinomial distribution, or for the modelling of counts within a given time period, we need to generalize the Linear Model.</p>
<p>Generalized Linear Models enable us to explicitly model the mean of a distribution from the exponential family, such that predictions lie in a feasible range and the relationship between the mean and the variance is appropriate to perform reliable inference. In this brief blog we discuss the intuition behind the Generalized Linear Model and Link function and prove the method of Iteratively ReWeighted Least Squares enables us to fit a GLM.</p>
<p>Generalized Linear Models have 3 components:</p>
<p><strong>1) Random Component Error Structure</strong></p>
<p><span class="math display">\[y_i \sim exponential \; family \; distibution\]</span></p>
<p>We also typically assume each <span class="math inline">\(y_i\)</span> is independent and identically distributed, although this assumption can be relaxed through the use of Generalized Estimating Equations (GEE’s).</p>
<p><strong>2) Systematic Component/ Linear Predictor</strong></p>
<p><span class="math display">\[\eta_i = \beta_0 + \sum_{i = 1}^{p}\beta_p x_{i, p}\]</span></p>
<p><strong>3) Link Function</strong></p>
<p><span class="math display">\[\mathop{\mathbb{E}}[y_i | x_{1, i}, ..., x_{p, i}] = \mu_i\]</span>
<span class="math display">\[g(\mu_i) = \eta_i\]</span></p>
<p>It should be made clear that we are not modellig the response <span class="math inline">\(y_i\)</span> explicitly, but rather modelling the mean of the distibution, <span class="math inline">\(\mu_i\)</span>. Predictions for each observation <span class="math inline">\(i\)</span> are given by <span class="math inline">\(\mu_i\)</span>, with each <span class="math inline">\(y_i\)</span> assumed to be centred around <span class="math inline">\(\mu_i\)</span> in expectation but with an error term that has a distibution specified by the member of the exponential family used. Therefore, the link function does not transform the response <span class="math inline">\(y_i\)</span> but instead transforms the mean <span class="math inline">\(\mu_i\)</span>. Note that the linear model is a specific type of GLM, where <span class="math inline">\(y_i \sim Normal\)</span> and <span class="math inline">\(g(\mu_i) = \mu_i = \eta_i = \beta_0 + \sum_{i = 1}^{p}\beta_p x_{i, p}\)</span>. For a Poisson GLM, each <span class="math inline">\(y_i\)</span> is a r.v. simulated from the Poisson distribution with mean <span class="math inline">\(\mu_i\)</span>, hence <span class="math inline">\(y_i\)</span> has a Poisson error distribution, the difference between <span class="math inline">\(y_i\)</span> and <span class="math inline">\(\hat{y_i} = \mu_i\)</span>.</p>
<div class="alert alert-info">
<p><strong>Why Bother with Parametric Assumptions</strong></p>
<p><strong>Advantages</strong>
- Large amounts of data can be modelled as random variables from the exponential family of distributions
- If there are relatively few observations, providing a structure for the model generating process can improve predictive performance
- Enables us to carry out inference on model covariates
- Simple and intuitive to understand. In some industries (such as insurance), this has huge benefits- it is transparent and can fit into a rate structure</p>
<p><strong>Disadvantages</strong>
- Validity of inference dependent on assumptions being satisfied
- Places a very rigid structure on the relationship between the independent and dependent variables
- Typically has worse predictive performance than non-linear models, such as Boosted Trees and Neural Networks, due to linearity and inability to account for complex interactions</p>
</div>
</div>
<div id="link-functions" class="section level2">
<h2>Link Functions</h2>
<p>So Generalized Linear models explicitly introduce a link function (the link function for the linear model is simply the identity, <span class="math inline">\(g(\mu) = \mu\)</span>) and through the specification of a mean-variance relationship (the response belongs to a member of the exponential family). Using a link function allows us to transform values of the linear predictor to predictions of the mean, such that these predictions are always contained within the range of possible values for the mean, <span class="math inline">\(\mu_i\)</span>.</p>
<p>When choosing a link function, there is no ‘correct’ choice, however there are a few properties we require to be able to interpret and fit a model:</p>
<ol style="list-style-type: decimal">
<li><p>The link function transforms the linear predictor such that the prediction of <span class="math inline">\(\mu_i\)</span> for each <span class="math inline">\(y_i\)</span> is within the range of possible values of <span class="math inline">\(\mu\)</span>.</p></li>
<li><p>The link function must be <em>monotonic</em> and therefore have a <em>unique inverse</em>. That is, each value on the linear predictor must be mapped to a unique value of the mean and the link function must preserve the order/ranking of predictions.</p></li>
<li><p>The link function must be <em>differentiable</em>, in order to estimate model coefficients.</p></li>
</ol>
<p>For OLS, the linear predictor <span class="math inline">\(X\beta\)</span> can take on any value in the range <span class="math inline">\((-\infty, \infty)\)</span>. For a Poisson model, we require the rate parameter <span class="math inline">\(\mu\)</span> (equivalent to the commonly used <span class="math inline">\(\lambda\)</span>), to lie in the range <span class="math inline">\((0, \infty)\)</span>, thus we need a link function that transforms the linear predictor <span class="math inline">\(\eta\)</span> to lie in this range. The common choice of link function for a Poisson GLM is the log-link (<span class="math inline">\(\log(\mu_i) = \eta_i\)</span>). Exponentiating the linear predictor results in <span class="math inline">\(\mu_i \in (0, \infty)\)</span> as required for count data modeled via a Poisson. The log-link also results in a nice interpretation, since it exponentiates the linear predictor resulting in a multiplication of exponentiated coefficients: <span class="math inline">\(log(\mu_i) = exp(\beta_0 + \beta_1 x_{1, i}) = \exp(\beta_0) \exp(\beta_1 x_{1, i})\)</span>. Note that we can’t use the square root function as a link function since it does not have a <em>unique inverse</em> (i.e. <span class="math inline">\(\sqrt(4) = \pm 2\)</span>).</p>
<p>For the Binomial, we choose a link function that maps <span class="math inline">\(p_i\)</span>, the probability of success to the interval <span class="math inline">\([0, 1]\)</span>. The link function <span class="math inline">\(g(\mu_i) = log(\frac{p_i}{n - p_i}) = X \beta_i\)</span> is one candidate. This transforms the Linear predictor: <span class="math inline">\(\frac{p_i}{1 - p_i} = \exp(X \beta_i)\)</span> <span class="math inline">\(\implies p_i = (\frac{e^{X \beta_i}}{1 + e ^ {X \beta_i}}) \in [0, 1]\)</span> to the required range.</p>
<p>Whilst we are able to choose any link function that satisfies these properties, the usual choice is to select the <em>Canonical</em> link function, which arises from writing the distribution in its exponential form. These link functions have nice mathematical properties and simplify the derivation of the Maximum Likelihood Estimators. We could also use an Information Criteria such as AIC to choose the best-fitting link function, although there is usually little deviation in performance, so the common choice is to use the link function with the most intuitive interpretation (which is often the canonical link function anyway).</p>
<p>Some common distributions and Canonical links are show below:</p>
<table>
<colgroup>
<col width="10%" />
<col width="43%" />
<col width="46%" />
</colgroup>
<thead>
<tr class="header">
<th>Family</th>
<th>Canonical Link (<span class="math inline">\(\eta = g(\mu)\)</span>)</th>
<th>Inverse Link (<span class="math inline">\(\mu = g^{-1}(\eta)\)</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Binomial</td>
<td>Logit: <span class="math inline">\(\eta = log \left( \frac{\mu}{n - \mu} \right)\)</span></td>
<td><span class="math inline">\(\mu = \frac{n}{1 + e^{-n}}\)</span></td>
</tr>
<tr class="even">
<td>Gaussian</td>
<td>Identity: <span class="math inline">\(\eta = \mu\)</span></td>
<td><span class="math inline">\(\mu = \eta\)</span></td>
</tr>
<tr class="odd">
<td>Poisson</td>
<td>Log: <span class="math inline">\(\eta = log(\mu)\)</span></td>
<td><span class="math inline">\(\mu = e^{\eta}\)</span></td>
</tr>
<tr class="even">
<td>Gamma</td>
<td>Inverse: <span class="math inline">\(\eta = \frac{1}{\mu}\)</span></td>
<td><span class="math inline">\(\mu = \frac{1}{\eta}\)</span></td>
</tr>
</tbody>
</table>
</div>
<div id="the-exponential-family-of-distributions" class="section level2">
<h2>The Exponential Family of Distributions</h2>
<p>A random variable <span class="math inline">\(y\)</span> has a distribution from the exponential family if its probability density function is of the form:</p>
<p><span class="math display">\[f(y;\theta, \phi) = exp \left( \frac{y \theta - b(\theta)}{a(\phi)} + c(y, \phi) \right)\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(\theta\)</span> is the location parameter of the distribution</p></li>
<li><p><span class="math inline">\(a(\phi)\)</span> is the scale/dispersion parameter</p></li>
<li><p><span class="math inline">\(c(y, \phi)\)</span> is a normalization term</p></li>
</ul>
<p>It can also be shown that <span class="math inline">\(\mathop{\mathbb{E}}[y] = b&#39;(\theta)\)</span> and <span class="math inline">\(Var[y] = b&#39;&#39;(\theta) a(\phi)\)</span>.</p>
</div>
<div id="likelihood-analysis-and-newton-raphson-method" class="section level2">
<h2>Likelihood Analysis and Newton-Raphson Method</h2>
<p>The fitting of any form of Statistical Learning algorithm involves an optimization problem. Optimization refers to the task of either minimizing or maximizing some function <span class="math inline">\(f(\mathbf{\beta})\)</span> by altering <span class="math inline">\(\beta\)</span>. We usually phrase most optimization problems in terms of minimizing <span class="math inline">\(f(\beta)\)</span>. For the case of parametric learning models (we place distributional assumptions on the target/response <span class="math inline">\(y_i\)</span>, such that they are drawn independently from some probability distribution <span class="math inline">\(p_{model}(y, \theta)\)</span>), one can also use the process of Maximum Likelihood to find model coefficients. Under this approach, we have the following optimization problem:</p>
<p><span class="math display">\[\mathbf{\beta}^* =arg max(l(y_i | \mathbf{\beta}))\]</span></p>
<p>where <span class="math inline">\(l(y_i | \mathbf{\beta})\)</span> is the likelihood function. The likelihood can be interpreted as the probability of seeing the data in our sample given the parameters and we naturally wish to maximize this quantity to obtain a good model fit.</p>
<div class="alert alert-info">
<p><strong>Why Maximum Likelihood?</strong></p>
<ol style="list-style-type: decimal">
<li><p>Simple and intuitive method to find estimates for any <em>parametric</em> model.</p></li>
<li><p>For large samples, MLE’s have useful properties, assuming large n and i.i.d (independent and identically distributed) samples.</p></li>
</ol>
<ol style="list-style-type: lower-alpha">
<li><p><span class="math inline">\(\mathop{\mathbb{E}}[\hat{\theta}_{MLE}] = \theta\)</span> (<strong>Unbiased</strong>)</p></li>
<li><p><span class="math inline">\(Var(\hat{\theta}_{MLE}) = \frac{1}{n I(\theta)}\)</span>, where <span class="math inline">\(I(\theta)\)</span> is the Fisher Information in the sample. That is, we can calculate the variance of model coefficients and hence perform inference</p></li>
<li><p>The MLE also achieves the <strong>Cramer Lower Bound</strong>, that is it has the smallest variance of any estimator, thus is <strong>Asymptotically Efficient</strong>.</p></li>
</ol>
<p>However, there are several disadvantages to Maximum Likelihood, particularly if the purpose of modelling is for prediction. Under Maximum Likelihood, we fit exactly to the training dataset, resulting in overfitting and poor generalization to unseen data.</p>
</div>
<p>Consider the general form of the probability density function for a member of the exponential family of distributions:</p>
<p><span class="math display">\[f(y;\theta, \phi) = exp \left( \frac{y \theta - b(\theta)}{a(\phi)} + c(y, \phi) \right)\]</span></p>
<p>The likelihood is then (assuming independence of observations):</p>
<p><span class="math display">\[L(f(y_i)) = \prod_{i = 1}^n exp \left( \frac{1}{a(\phi)} (y_i \theta_i - b(\theta_i) + c(y_i, \phi) \right)\]</span></p>
<p>with log-likelihood (since the log of the product of exponentials is the sum of the exponentiated terms):</p>
<p><span class="math display">\[log(L(f(y_i))) = l(f(y_i)) = \sum_{i = 1}^n \frac{1}{a(\phi)}(y_i \theta_i - b(\theta_i)) + c(y_i, \phi)\]</span></p>
<p>Since the logarithmic function is monotonically increasing, order is preserved hence finding the maximum of the log-likelihood yields the same result as finding the maximum of the likelihood. We wish to maximize this log-likelihood, hence we can differentiate, equate to zero and solve for <span class="math inline">\(\beta_j\)</span> (We could also ensure the second derivative evaluated at <span class="math inline">\(\beta_j\)</span> is negative, therefore we have maximized (and not minimized) the log-likelihood). Via the Chain Rule we have:</p>
<p><strong>Equation 1</strong></p>
<p><span class="math display">\[\frac{\partial l(f(y_i))}{\partial \beta_j} = \sum_{i = 1}^n \frac{\partial l(f(y_i))}{\partial \theta_i} \frac{\partial \theta_i}{\partial \mu_i} \frac{\partial \mu_i}{\partial \eta_i} \frac{\partial \eta_i}{\partial \beta_j} = 0\]</span></p>
<p>This is also known as the Score function, since it tells us how sensitive the model is to changes in <span class="math inline">\(\beta\)</span> at a given value of <span class="math inline">\(\beta\)</span>. Since we differentiate with respect to each coefficent, <span class="math inline">\(\beta_j\)</span> (<span class="math inline">\(j \in [0, 1, ..., K]\)</span>), we have a system of <span class="math inline">\((K + 1)\)</span> equations to solve.</p>
<div class="alert alert-info">
<p><strong>Chain Rule</strong></p>
<p>The Chain Rule is often used in Optimization problems. Here we utilize the chain rule by recognizing that, as seen in <strong>Equation 1</strong>, the likelihood is a function of the location parameter of the distribution, <span class="math inline">\(\theta\)</span>, which in turn is a function of the mean <span class="math inline">\(\mu\)</span>. Via the link function, we have that <span class="math inline">\(g(\mu_i) = \eta_i\)</span> and via the linear predictor, <span class="math inline">\(\eta_i = \beta_0 + \sum_{i = 1}^{p}\beta_p x_{i, p}\)</span>.</p>
</div>
<p>Each of these individual partial derivatives can then be identified:</p>
<p><span class="math display">\[\frac{\partial l_i}{\partial \theta_i} = \frac{y_i - b&#39;(\theta_i)}{a(\phi)}\]</span></p>
<p><span class="math display">\[\frac{\partial \theta_i}{\partial \mu_i} = \frac{1}{V(\mu_i)}\]</span></p>
<p>since <span class="math inline">\(\frac{\mu_i}{\theta_i} = b&#39;&#39;(\theta_i) = V(\mu_i)\)</span> where V is the variance function of the model as it dictates the mean-variance relationship.</p>
<p><span class="math display">\[\frac{\partial \mu_i}{\partial \eta_i} = \frac{1}{g&#39;(\mu_i)}\]</span></p>
<p>since <span class="math inline">\(g(\mu_i) = \eta_i \implies \frac{\partial \eta_i}{\partial \mu_i} = g&#39;(\mu_i)\)</span>. Finally:</p>
<p><span class="math display">\[\frac{\partial \eta_i}{\partial \beta_j} = x_j\]</span></p>
<p>Putting this all together yields the Maximum Likelihood Equations:</p>
<p><strong>Equation 2</strong></p>
<p><span class="math display">\[\sum_{i = 1}^n \frac{(y_i - \mu_i) x_{i, j}}{a(\phi) V(\mu_i) g&#39;(\mu_i)} = 0\]</span></p>
<div class="alert alert-info">
<p><strong>Least Square Vs Maximum Likelihood</strong></p>
<p>Under Gaussian assumptions, both Ordinary Least Squares (OLS) and Maximum Likelihood yield the same solution (assuming there is no collinearity/near collinearity between features such that the design matrix is invertible). Both methods aim to minimize the Residual Sum of Squares under these assumptions. One could also use numeric optimization, such as <em>Gradient Descent</em>, although this will not yield an exact solution.</p>
</div>
<p><strong>Equation 2</strong> does not have a closed form solution, except when we have a Gaussian Linear Model.</p>
<p>To solve the <strong>Equation 2</strong>, we must find coefficients <span class="math inline">\(\beta_j\)</span> (which for each observation <span class="math inline">\(y_i\)</span> affect our prediction of <span class="math inline">\(\mu_i\)</span>, <span class="math inline">\(g&#39;(\mu_i)\)</span> and <span class="math inline">\(V(\mu_i)\)</span> via our distributional assumptions for the relationship between the mean and the variance), such that summing these terms over all observations yields 0. To solve this, we use the numerical Newton - Raphson Method, which when applied to the fitting of GLMs is knows as <em>Iteratively Reweighted Least Squares</em>.</p>
</div>
<div id="iteratively-reweighted-least-squares-irls" class="section level2">
<h2>Iteratively Reweighted Least Squares (IRLS)</h2>
<p>Recall the Newton - Raphson method for a single dimension. We wish to find the root of the function; in this case the value of <span class="math inline">\(\beta\)</span> such that the derivative of the log-likelihood is 0. In One-Dimension, to find the root of function f we have:</p>
<p><span class="math display">\[x_{t+1} = x_t - \frac{f(x_t)}{f&#39;(x_t)}\]</span></p>
<p>The closer <span class="math inline">\(f(x_t)\)</span> is to 0, the closer we are to the root, hence the step change between iterations will be smaller.</p>
<center>
<div class="figure">
<img src="NewtonRaphson.png" alt="" />
<p class="caption">Newton Raphson- Finding the root of f(x) via iteration in one dimension</p>
</div>
</center>
<p><br />
</p>
<p>Instead of the log-likelihood function <span class="math inline">\(f(x)\)</span>, we want to optimize its derivative:</p>
<p><span class="math display">\[x_{t+1} = x_t - \frac{f&#39;(x_t)}{f&#39;&#39;(x_t)}\]</span></p>
<p>or for the vector of coefficient estimates at iteration t:</p>
<p><span class="math display">\[\beta_{t+1} = \beta_t - \left( \frac{\partial l}{\partial \beta_j}(\beta_t) \right) \left( \frac{\partial^2 l}{\partial \beta_j \partial \beta_k} \right)^{-1}\]</span></p>
<p>The Newton-Raphson technique is derived by considering the <em>Taylor Expansion</em> about the solution <span class="math inline">\(\beta^*\)</span> (that sets <span class="math inline">\(\frac{\partial l}{\partial \beta}\)</span> to zero).</p>
<p><span class="math display">\[0 = \frac{\partial l}{\partial \beta}(\beta^*) - (\beta - \beta^*) \frac{\partial^2 l}{\partial \beta_j \beta_k} + ...\]</span></p>
<p>If we ignore all derivative terms higher than <span class="math inline">\(2^{nd}\)</span> order, we can derive an iterative solution. Generalizing to multiple dimensions we have:</p>
<p><span class="math display">\[\beta_{t + 1} = \beta_t - \mathbf{H}^{-1}_t \mathbf{U}_t\]</span></p>
<p>where <span class="math inline">\(\mathbf{U}_t\)</span> is the Score Vector evaluated at <span class="math inline">\(\beta_t\)</span>. <span class="math inline">\(\mathbf{H}_t\)</span> denotes the (p + 1) x (p + 1) Hessian matrix of second Derivatives.</p>
<p>Given the Score function <span class="math inline">\(\frac{\partial l}{\beta_j} = \nabla_{\beta} l = \frac{(y_i - \mu_i)}{a(\phi)} \frac{x_{i,j}}{V(\mu_i)}\frac{1}{g&#39;(\mu_i)}\)</span>, the Hessian is:</p>
<p><strong>Equation 3</strong></p>
<p><span class="math display">\[\nabla^2_{\beta} = \sum_{i = 1}^n \frac{x_{i,j}}{a(\phi)} \left( (y_i - \mu_i)&#39; \frac{1}{g&#39;(\mu_i)} \frac{1}{V(\mu_i)} \right) + (y_i - \mu_i) \left( \frac{1}{g&#39;(\mu_i)} \frac{1}{V(\mu_i)} \right) &#39; \]</span></p>
<p>by Product Rule. <span class="math inline">\(y_i\)</span> is a data point so does not depend on <span class="math inline">\(\beta\)</span>. The partial derivative of <span class="math inline">\(\mu_i\)</span> is then:</p>
<p><span class="math display">\[\frac{\partial \mu_i}{\partial \beta_k} = \frac{\mu_i}{\eta_i} \frac{\eta_i}{\beta_k} = \frac{1}{g&#39;(\mu_i)} x_k\]</span></p>
<p>substituting, the first term of <strong>equation 3</strong> becomes:</p>
<p><span class="math display">\[\frac{x_{i,j}}{a(\phi)} \left( - \frac{x_{i, k}}{g&#39;(\mu_i)} \right) \frac{1}{g&#39;(\mu_i)} \frac{1}{V(\mu_i)} = - \frac{x_{i, j} x_{i, k}}{a(\phi)(g&#39;(\mu_i))^2} \frac{1}{V(\mu_i)}\]</span></p>
<p>Now consider the <span class="math inline">\(2^{nd}\)</span> term in <strong>equation 3</strong>:</p>
<p><span class="math display">\[\left( \frac{1}{g&#39;(\mu_i)} \frac{1}{V(\mu_i)} \right)&#39;\]</span></p>
<p>Using Newton-Raphson, we would need to calculate this derivative. However, we can instead utilize <strong>Fisher Scoring</strong>, ensuring this derivative term cancels out.</p>
<div class="alert alert-info">
<p><strong>Fisher Scoring</strong></p>
<p>Fisher Scoring is a form of Newton’s Method used in statistics to solve Maximum Likelihood equations numerically. Instead of using the inverse of the Hessian, we use the inverse of the Fisher Information matrix.</p>
<p><span class="math display">\[\beta_{t+1} = \beta_t + J^{-1} \nabla l\]</span> where <span class="math inline">\(J = \mathop{\mathbb{E}}[- \nabla^2 l]\)</span>, the expected value of the negative Hessian.</p>
</div>
<p>Taking the negative expected value from <strong>equation 3</strong>, the first term becomes</p>
<p><span class="math display">\[\mathop{\mathbb{E}} \left( \frac{x_{i,j} x_{i,k}}{a(\phi) (g&#39;(\mu_i))^2} \frac{1}{V(\mu_i)} \right) = \frac{x_{i,j} x_{i,k}}{a(\phi) (g&#39;(\mu_i))^2} \frac{1}{V(\mu_i)}\]</span></p>
<p>since none of the above values depend on <span class="math inline">\(y\)</span> hence are all constant. The <span class="math inline">\(2^{nd}\)</span> term in <strong>equation 3</strong> becomes:</p>
<p><span class="math display">\[\mathop{\mathbb{E}} \left( - \frac{x_{i,j}}{a(\phi)}(y_i - \mu_i) \left( \frac{1}{g&#39;(\mu_i) V(\mu_i)} \right) &#39; \right) \\ = - \frac{x_{i,j}}{a(\phi)}(y_i - \mu_i) \left( \frac{1}{g&#39;(\mu_i) V(\mu_i)} \right)&#39; \mathop{\mathbb{E}}(y_i - \mu_i)\]</span></p>
<p>but <span class="math inline">\(\mathop{\mathbb{E}}(y_i - \mu_i) = 0\)</span> hence the second term of <strong>equation 3</strong> vanishes. We then have:</p>
<p><span class="math display">\[J = \sum_{i = 1}^n \frac{x_{i,j} x_{i,k}}{a(\phi) (g&#39;(\mu_i))^2 \frac{1}{V(\mu_i)}} = \mathbf{X}^T \mathbf{W} \mathbf{X}\]</span></p>
<p>where</p>
<p><span class="math display">\[\mathbf{W} = \frac{1}{a(\phi)} \begin{bmatrix} \frac{1}{V(\mu_1) (g&#39;(\mu_1))^2} &amp;  &amp; \\ &amp; ... &amp; \\ &amp; &amp; \frac{1}{V(\mu_n)(g&#39;(\mu_n))^2}\\ \end{bmatrix}\]</span></p>
<p>From Fisher Scoring, we have:</p>
<p><span class="math display">\[\mathbf{\beta}_{t+1} = \mathbf{\beta_t} = \mathbf{J}^{-1} \nabla_{\beta} l (\beta_t)\]</span></p>
<p>We can rewrite <span class="math inline">\(\nabla_{\beta}l = \sum_{i = 1}^n \frac{y_i - \mu_i}{a(\phi)} \frac{1}{a(\phi)} \frac{x_{i,j}}{V(\mu_i g&#39;(\mu_i))}\)</span> as <span class="math inline">\(\mathbf{X}^T \mathbf{D} \mathbf{V}^{-1} (y - \mu)\)</span> where:</p>
<p><span class="math display">\[\mathbf{D} = \begin{bmatrix} \frac{1}{g&#39;(\mu_1)} &amp; &amp; \\ &amp; ... &amp; \\ &amp; &amp; \frac{1}{g&#39;(\mu_n)} \\ \end{bmatrix}\]</span></p>
<p><span class="math display">\[\mathbf{V}^{-1} = \frac{1}{a(\phi)} \begin{bmatrix} \frac{1}{V(\mu_1)} &amp; &amp; \\ &amp; ... &amp; \\ &amp; &amp; \frac{1}{V(\mu_n)} \\ \end{bmatrix}\]</span></p>
<p>Then for the Fisher Equation:</p>
<p><span class="math display">\[\mathbf{\beta}_{t+1} = \mathbf{\beta}_t + (\mathbf{X}^T \mathbf{W} \mathbf{X})^{-1} \mathbf{X}^T \mathbf{D} \mathbf{V}^{-1} (\mathbf{y} - \mathbf{\mu})\]</span></p>
<p>We can write this more generally, by noting that <span class="math inline">\(\mathbf{W}\)</span> is the same as <span class="math inline">\(\mathbf{D} \mathbf{V}^{-1}\)</span>, except we have <span class="math inline">\(\frac{1}{(g&#39;(\mu_i))^2}\)</span>.</p>
<p><span class="math display">\[\implies \mathbf{D} \mathbf{V}^{-1} = \mathbf{W M}\]</span></p>
<p>where</p>
<p><span class="math display">\[\mathbf{M} = \begin{bmatrix}  \frac{1}{g&#39;(\mu_1)} &amp; &amp; \\ &amp; ... &amp; \\ &amp; &amp; \frac{1}{g&#39;(\mu_1)} \\ \end{bmatrix}\]</span></p>
<p><span class="math display">\[\implies \beta_{t + 1} = \beta_t + (X^T W X)^{-1} X^T W M (y - \mu)\]</span></p>
<p>Each term can be calculated and used to generate an iterative model-fitting algorithm for updating the esimates <span class="math inline">\(\beta_t\)</span> at each iteration. We then set a convergence condition such at if the increase in the value of the likelihood function between iterations is arbitrarily small (<span class="math inline">\(\epsilon\)</span>), the algorithm stops and outputs the values of <span class="math inline">\(\beta_t\)</span> at iteration <span class="math inline">\(t\)</span>, as estimates for <span class="math inline">\(\beta\)</span>.</p>
<p>This result can be further simplified</p>
<p><strong>Equation 4- Iteratively Reweighted Least Squares</strong></p>
<p><span class="math display">\[\beta_{t+1} = (X^T W X)^{-1} (X^T W X) \beta_t + (X^T W X)^{-1} X^T W M (y - \mu) \\ =
  (X^T W X)^{-1} X^T W (X \beta_t + M (y - \mu)) \\ =
  (X^T W X)^{-1} X^T W Z_t\]</span></p>
<p>where <span class="math inline">\(Z_t := \eta_t + M(y - \mu)\)</span></p>
<p>From <strong>Equation 4</strong>, the step size at each iteration mainly depends on <span class="math inline">\(Z_t\)</span> and <span class="math inline">\(W\)</span>. Larger <span class="math inline">\((y - \mu)\)</span> (in a relative sense) indicates a model which is poorly fit hence we require larger adjustments to <span class="math inline">\(\beta_t\)</span> to converge more quickly to a reasonable fit before we start iterating in a more granular manner.</p>
<p>Recall, we have shown <span class="math inline">\(\frac{\partial l_i}{\beta_j} \propto \frac{1}{g&#39;(\mu_i)}\)</span>. <span class="math inline">\(g&#39;(\mu_i)\)</span> is the derivative of the link function, giving the rate of change of model predictions w.r.t. <span class="math inline">\(\beta\)</span>. Thus, larger values of <span class="math inline">\(g&#39;(\mu_i)\)</span> indicate a model whose fit is sensitive to small changes in <span class="math inline">\(\beta\)</span>, so is not close to at least a local (ideally a global) optima. In this case, larger step changes are required.</p>
<p>The Hessian matrix of <span class="math inline">\(2^{nd}\)</span> derivatives adjusts the step change depending on the curvature of the gradient of the likelihood function at <span class="math inline">\(\beta_t\)</span>, information encapsulated in the matrix <span class="math inline">\(W\)</span>, allowing one to optimize step changes depending on the shape of the likelihood function at <span class="math inline">\(\beta\)</span>. For example, if the <span class="math inline">\(2^{nd}\)</span> derivative is negative (the gradient of the likelihood function is becoming more negative for a small increase <span class="math inline">\(\epsilon\)</span> at <span class="math inline">\(x\)</span>), the likelihood function curves downwards, so the likelihood will decrease by more than anticipated by the <span class="math inline">\(1^{st}\)</span> derivative alone.</p>
<div class="alert alert-info">
<p><strong>Derivation of Model Fitting Algorithms/Coefficients</strong></p>
<p>This derivation of Iteratively Reweighted Least Squares for GLMs follows a similar procedure to the derivation of any numerical model fitting algorithm. Firstly, we identify an objective function over which to optimize. Typical Machine Learning problems involve minimizing some loss function, which measures the discrepency between actual and predicted target values. <em>Gradient Descent</em> and its variations are often used for solving such optimization problems.</p>
</div>
</div>
<div id="conclusion" class="section level2">
<h2>Conclusion</h2>
<p>Generalized Linear Models are used in a wide array of fields. GLM’s are particularly useful when we expect the target variable to have been generated by a distribution from the exponential family, with a mean-variance relationship proportional to that of the modelled distribution.</p>
<p>Whilst GLM’s tend to be outperformed by models capable of accounting for non-linearities and multi-dimensional interactions, they are highly appropriate for inference and may outperform more complex models if there is a lack of data available.</p>
</div>

    </div>

    






<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/optimization/">Optimization</a>
  
  <a class="badge badge-light" href="/tag/glms/">GLMs</a>
  
  <a class="badge badge-light" href="/tag/mathematical-statistics/">Mathematical Statistics</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https://domscruton.github.io/post/irls/&amp;text=GLMs:%20Intuition%20behind%20the%20Link%20function%20and%20Derivation%20of%20Iteratively%20Reweighted%20Least%20Squares" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https://domscruton.github.io/post/irls/&amp;t=GLMs:%20Intuition%20behind%20the%20Link%20function%20and%20Derivation%20of%20Iteratively%20Reweighted%20Least%20Squares" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=GLMs:%20Intuition%20behind%20the%20Link%20function%20and%20Derivation%20of%20Iteratively%20Reweighted%20Least%20Squares&amp;body=https://domscruton.github.io/post/irls/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https://domscruton.github.io/post/irls/&amp;title=GLMs:%20Intuition%20behind%20the%20Link%20function%20and%20Derivation%20of%20Iteratively%20Reweighted%20Least%20Squares" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="whatsapp://send?text=GLMs:%20Intuition%20behind%20the%20Link%20function%20and%20Derivation%20of%20Iteratively%20Reweighted%20Least%20Squares%20https://domscruton.github.io/post/irls/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https://domscruton.github.io/post/irls/&amp;title=GLMs:%20Intuition%20behind%20the%20Link%20function%20and%20Derivation%20of%20Iteratively%20Reweighted%20Least%20Squares" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>











  
  



  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <a href="https://domscruton.github.io/"><img class="avatar mr-3 avatar-circle" src="/authors/dominic/avatar_hu25097a9853080b55ebddd3b74e1e5ffa_147961_270x270_fill_q75_lanczos_center.jpg" alt="Dominic Scruton"></a>
    

    <div class="media-body">
      <h5 class="card-title"><a href="https://domscruton.github.io/">Dominic Scruton</a></h5>
      <h6 class="card-subtitle">Data Scientist</h6>
      
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/Domscruton" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://uk.linkedin.com/in/dominicscruton" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>
















  
  





  </div>
</article>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">

  



  

  

  
  <p class="powered-by">
    © 2022 Dominic Scruton
  </p>
  

  
  






  <p class="powered-by">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a> — the free, <a href="https://github.com/wowchemy/wowchemy-hugo-modules" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>
</footer>

    </div>
    
  </div>

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      

    
    <script src="/js/vendor-bundle.min.b73dfaac3b6499dc997741748a7c3fe2.js"></script>

    
    
    
      
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      

      
      

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js" integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin="anonymous"></script>
        
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js" crossorigin="anonymous"></script>
        
      

    

    
    
    

    
    

    
    
    
      
      <script id="search-hit-fuse-template" type="text/x-template">
        <div class="search-hit" id="summary-{{key}}">
          <div class="search-hit-content">
            <div class="search-hit-name">
              <a href="{{relpermalink}}">{{title}}</a>
              <div class="article-metadata search-hit-type">{{type}}</div>
              <p class="search-hit-description">{{snippet}}</p>
            </div>
          </div>
        </div>
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
      
    

    
    

    
    
    
    

    
    
      
      
      
      
      
      
      
    

    
    
    
    
    
    
    
    
      
      
    
    
    <script src="/en/js/wowchemy.min.d68ecd57c0ec1f1f61d65fd568f1c3a0.js"></script>

    






</body>
</html>
